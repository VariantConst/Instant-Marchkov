<form id="reservationForm" class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
	<div class="mb-4">
		<label class="block text-gray-700 text-sm font-bold mb-2" for="username">
			Username
		</label>
		<input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="username" type="text" placeholder="Username" required>
	</div>
	<div class="mb-4">
		<label class="block text-gray-700 text-sm font-bold mb-2" for="password">
			Password
		</label>
		<input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline" id="password" type="password" placeholder="******************" required>
	</div>
	<div class="mb-4">
		<label class="block text-gray-700 text-sm font-bold mb-2" for="target_time">
			Target Time
		</label>
		<input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="target_time" type="time" required>
	</div>
	<div class="flex items-center justify-between">
		<button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" type="submit">
			Get Reservations
		</button>
	</div>
</form>

<script>
	const form = document.getElementById('reservationForm');
	form.addEventListener('submit', async (e) => {
		e.preventDefault();
		const username = document.getElementById('username').value;
		const password = document.getElementById('password').value;
		const target_time = document.getElementById('target_time').value;

		try {
			const toYanyuanResponse = await fetch('http://localhost:8000/get_qr_code', {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json',
				},
				body: JSON.stringify({ username, password, target_time, is_return: false }),
			});
			const toYanyuanData = await toYanyuanResponse.json();
			
			const toChangpingResponse = await fetch('http://localhost:8000/get_qr_code', {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json',
				},
				body: JSON.stringify({ username, password, target_time, is_return: true }),
			});
			const toChangpingData = await toChangpingResponse.json();

			// Dispatch custom events with the results
			window.dispatchEvent(new CustomEvent('toYanyuanResult', { detail: toYanyuanData }));
			window.dispatchEvent(new CustomEvent('toChangpingResult', { detail: toChangpingData }));
		} catch (error) {
			console.error('Error:', error);
			alert('An error occurred while fetching the reservations.');
		}
	});
</script>